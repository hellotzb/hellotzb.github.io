(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f2f81c36"],{"0418":function(t,a,o){"use strict";var i=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"header"},[o("van-icon",{staticClass:"left",attrs:{name:"arrow-left"},on:{click:t.back}}),o("p",[t._t("default")],2),t.star&&!t.loading?[t.bool?o("van-icon",{staticClass:"right",class:{active:t.collect},attrs:{name:"star"},on:{click:t.remove}}):o("van-icon",{staticClass:"right",attrs:{name:"star-o"},on:{click:t.add}})]:t._e()],2)},e=[],s=(o("4160"),o("159b"),o("5530")),n=o("2f62"),r={name:"Header",props:["loading"],computed:Object(s["a"])(Object(s["a"])({},Object(n["c"])(["star","collect","currentBook"])),{},{bool:function(){var t=this,a=!1;return this.collect.length&&this.collect.forEach((function(o){o.id==t.$route.query.id&&(a=!0)})),a}}),methods:Object(s["a"])(Object(s["a"])({},Object(n["b"])(["removeCollect","addCollect"])),{},{back:function(){this.$router.back()},add:function(){var t=this.currentBook,a=t._id,o=t.cover,i=t.title;this.addCollect({id:a,img:o,title:i})},remove:function(){this.removeCollect(this.$route.query.id)}})},c=r,l=(o("75bc"),o("2877")),u=Object(l["a"])(c,i,e,!1,null,"4408bcba",null);a["a"]=u.exports},1253:function(t,a,o){"use strict";o.r(a);var i=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"book-detail"},[o("Header",{attrs:{loading:t.loading}},[t._v("书籍详情")]),o("van-skeleton",{attrs:{title:"",avatar:"",row:3,loading:t.loading,"avatar-shape":"square"}},[t.currentBook?o("div",{staticClass:"book"},[o("div",{staticClass:"detail"},[o("div",{staticClass:"pic"},[o("img",{attrs:{src:"http://statics.zhuishushenqi.com"+t.currentBook.cover}})]),o("div",{staticClass:"info"},[o("div",{staticClass:"title"},[t._v(t._s(t.currentBook.title))]),o("div",{staticClass:"other"},[o("span",{staticClass:"author"},[t._v(t._s(t.currentBook.author))]),o("span",{staticClass:"split"},[t._v("|")]),o("span",{staticClass:"cate"},[t._v(t._s(t.currentBook.majorCate))]),o("span",{staticClass:"split"},[t._v("|")]),o("span",{staticClass:"popularity"},[t._v(t._s(t.popularity)+"人气")])]),o("div",{staticClass:"retention"},[t._v(" 读者留存率："+t._s(t.currentBook.retentionRatio)+"% ")]),o("div",{staticClass:"update"},[t._v(" 更新时间："+t._s(t.date)+" "),t.bool?o("van-button",{attrs:{type:"default",size:"mini",color:"#2495f3",round:""},on:{click:t.continueRead}},[t._v("继续阅读")]):o("van-button",{attrs:{type:"default",size:"mini",color:"#2495f3",round:""},on:{click:t.startRead}},[t._v("开始阅读")])],1)])]),o("van-divider",{style:{backgroundColor:"#fff",borderColor:"#ddd",margin:0,padding:"0 10px"}}),o("div",{staticClass:"desc",class:{short:t.isShort}},[t._v(" "+t._s(t.currentBook.longIntro)+" "),t.isShort?o("van-icon",{attrs:{name:"arrow-down"},on:{click:function(a){t.isShort=!1}}}):o("van-icon",{attrs:{name:"arrow-up"},on:{click:function(a){t.isShort=!0}}})],1),o("van-divider",{style:{backgroundColor:"#fff",borderColor:"#ddd",margin:0,padding:"10px 10px 0 10px"}}),o("div",{staticClass:"catalogue",on:{click:function(a){t.show=!0}}},[o("p",[t._v("目录")]),o("div",{staticClass:"lastest"},[o("p",[t._v("最新章节："+t._s(t.currentBook.lastChapter))]),o("van-icon",{attrs:{name:"arrow"}})],1)]),t.shortNum?o("div",{staticClass:"shortcomment"},[o("div",{staticClass:"title"},[t._v(" 热门短评"),o("span",[t._v(t._s(t.shortNum)+"条")])]),o("van-divider",{style:{backgroundColor:"#fff",borderColor:"#ddd",margin:0,padding:"8px 0 0 0"}}),o("van-swipe",{attrs:{"show-indicators":!1,vertical:"",autoplay:3e3,touchable:!1}},t._l(t.shortComment,(function(a,i){return o("van-swipe-item",{key:i},[o("div",{staticClass:"info"},[o("div",{staticClass:"avatar"},[o("img",{attrs:{src:"http://statics.zhuishushenqi.com"+a.author.avatar}})]),o("div",{staticClass:"nickname"},[t._v(t._s(a.author.nickname))]),o("div",{staticClass:"level"},[t._v("Lv."+t._s(a.author.lv))])]),o("div",{staticClass:"star"},[o("van-rate",{attrs:{size:14,color:"#ffd21e","void-icon":"star","void-color":"#eee",readonly:""},model:{value:a.rating,callback:function(o){t.$set(a,"rating",o)},expression:"item.rating"}}),o("span",[t._v(t._s(5==a.rating?"必看神作":4==a.rating?"非常喜欢":3==a.rating?"值得一看":2==a.rating?"打发时间":"浪费生命"))])],1),o("div",{staticClass:"content"},[t._v(t._s(a.content))]),o("div",{staticClass:"date"},[o("span",{staticClass:"dt"},[t._v(t._s(a.updated.split(/[T\.]/)[0]))]),o("span",{staticClass:"time"},[t._v(t._s(a.updated.split(/[T\.]/)[1]))])])])})),1)],1):t._e(),t.longNum?o("div",{staticClass:"longcomment"},[o("div",{staticClass:"title"},[t._v(" 热门书评"),o("span",[t._v(t._s(t.longNum)+"条")])]),o("van-divider",{style:{backgroundColor:"#fff",borderColor:"#ddd",margin:0,padding:"8px 0 0 0"}}),t._l(t.longComment.slice(0,3),(function(a,i){return o("div",{key:i,staticClass:"item"},[o("div",{staticClass:"info"},[o("div",{staticClass:"avatar"},[o("img",{attrs:{src:"http://statics.zhuishushenqi.com"+a.author.avatar}})]),o("div",{staticClass:"nickname"},[t._v(t._s(a.author.nickname))]),o("div",{staticClass:"level"},[t._v("Lv."+t._s(a.author.lv))])]),o("div",{staticClass:"star"},[o("van-rate",{attrs:{size:14,color:"#ffd21e","void-icon":"star","void-color":"#eee",readonly:""},model:{value:a.rating,callback:function(o){t.$set(a,"rating",o)},expression:"item.rating"}}),o("span",[t._v(t._s(5==a.rating?"必看神作":4==a.rating?"非常喜欢":3==a.rating?"值得一看":2==a.rating?"打发时间":"浪费生命"))])],1),o("div",{staticClass:"tit"},[t._v(t._s(a.title))]),o("div",{staticClass:"content"},[t._v(t._s(a.content))]),o("div",{staticClass:"bottom"},[o("div",{staticClass:"left"},[o("span",{staticClass:"dt"},[t._v(t._s(a.updated.split(/[T\.]/)[0]))]),o("span",{staticClass:"time"},[t._v(t._s(a.updated.split(/[T\.]/)[1]))])]),o("div",{staticClass:"right"},[o("van-icon",{attrs:{name:"good-job-o"}}),o("div",{staticClass:"likecount"},[t._v(t._s(a.likeCount))])],1)]),o("van-divider",{style:{backgroundColor:"#fff",borderColor:"#ddd",margin:0}})],1)})),t.longComment.length?o("div",{staticClass:"checkall",on:{click:t.toComment}},[t._v(" 查看全部"+t._s(t.longComment.length?t.longComment.length:0)+"条书评 ")]):t._e()],2):t._e(),t.relevant.length?o("div",{staticClass:"relevant"},[o("p",[t._v("相关推荐")]),o("van-divider",{style:{backgroundColor:"#fff",borderColor:"#ddd",margin:0,padding:"5px 0"}}),o("ul",t._l(t.relevant,(function(a,i){return o("li",{key:i,on:{click:function(o){return t.toDetail(a._id)}}},[o("img",{attrs:{src:"http://statics.zhuishushenqi.com"+a.cover}})])})),0)],1):t._e()],1):t._e()]),o("van-popup",{style:{height:"100%",width:"70%"},attrs:{position:"left",closeable:""},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[t.currentBookSource?o("Catalogue",{attrs:{count:t.currentBookSource.chaptersCount,chapters:t.currentBookChapters,loading:t.cataLoading}}):t._e()],1)],1)},e=[],s=(o("99af"),o("fb6a"),o("a9e3"),o("b680"),o("ac1f"),o("466d"),o("5530")),n=o("2f62"),r=o("0418"),c=o("5dd4"),l={name:"BookDetail",props:["shortComment","longComment"],components:{Header:r["a"],Catalogue:c["a"]},data:function(){return{isShort:!0,show:!1,loading:!0,cataLoading:!0,isFinish:!1,shortNum:0,longNum:0,axiosNum:0,relevant:[]}},computed:Object(s["a"])(Object(s["a"])({},Object(n["c"])(["currentBook","currentBookSource","currentBookChapters"])),{},{popularity:function(){return this.currentBook.latelyFollower>1e4?(this.currentBook.latelyFollower/1e4).toFixed(2)+"万":this.currentBook.latelyFollower},date:function(){var t=/\d{4}-\d{2}-\d{2}/gi;return this.currentBook.updated.match(t)[0]},bool:function(){return!!localStorage.getItem(this.$route.query.id)}}),watch:{currentBookChapters:function(){this.cataLoading=!1},isFinish:function(){console.log("目录加载完毕")},"$route.query.id":function(){this.initData(),this.renderPage()}},created:function(){this.renderPage()},beforeRouteEnter:function(t,a,o){o((function(t){t.$store.commit("updateStar",!0)}))},beforeRouteLeave:function(t,a,o){this.$store.commit("updateStar",!1),o()},methods:{initData:function(){this.isShort=!0,this.show=!1,this.loading=!0,this.cataLoading=!0,this.isFinish=!1,this.shortNum=0,this.longNum=0,this.axiosNum=0,this.relevant=[]},renderPage:function(){var t=this;this.axios.get("/book-info/".concat(this.$route.query.id)).then((function(a){t.$store.commit("updateCurrentBook",a.data),t.axiosNum=t.axiosNum+1,4==t.axiosNum&&(t.loading=!1)}));var a=this.axios.get("/book-sources?view=summary&book=".concat(this.$route.query.id)).then((function(a){t.$store.commit("updateCurrentBookSource",a.data[0])}));a.then((function(){t.axios.get("/book-chapters/".concat(t.currentBookSource._id)).then((function(a){t.$store.commit("updateCurrentBookChapters",a.data.chapters),t.isFinish=!0}))})),this.axios.get("/book/short-reviews?book=".concat(this.$route.query.id)).then((function(a){t.$emit("update:shortComment",a.data.docs),t.shortNum=a.data.docs.length,t.axiosNum=t.axiosNum+1,4==t.axiosNum&&(t.loading=!1)})),this.axios.get("/book/reviews?book=".concat(this.$route.query.id,"&limit=30")).then((function(a){a.data.reviews.length,t.$emit("update:longComment",a.data.reviews),t.longNum=a.data.reviews.length,t.axiosNum=t.axiosNum+1,4==t.axiosNum&&(t.loading=!1)})),this.axios.get("/recommend/".concat(this.$route.query.id)).then((function(a){t.relevant=a.data.books.slice(1,10),t.axiosNum=t.axiosNum+1,4==t.axiosNum&&(t.loading=!1)}))},startRead:function(){this.isFinish?this.$router.push("/chapter?id=".concat(this.currentBook._id,"&index=0")).catch((function(t){return t})):this.$toast("目录更新中...")},continueRead:function(){if(this.isFinish){var t=Number(localStorage.getItem(this.$route.query.id));this.$router.push("/chapter?id=".concat(this.currentBook._id,"&index=").concat(t)).catch((function(t){return t}))}else this.$toast("目录更新中...")},toComment:function(){var t=this.$route.query.id;this.$router.push({name:"Comment",query:{id:t}})},toDetail:function(t){this.$route.query.id!=t&&this.$router.push({name:"BookDetail",query:{id:t}})}}},u=l,d=(o("d5e0"),o("2877")),v=Object(d["a"])(u,i,e,!1,null,"7b229da7",null);a["default"]=v.exports},"466d":function(t,a,o){"use strict";var i=o("d784"),e=o("825a"),s=o("50c4"),n=o("1d80"),r=o("8aa5"),c=o("14c3");i("match",1,(function(t,a,o){return[function(a){var o=n(this),i=void 0==a?void 0:a[t];return void 0!==i?i.call(a,o):new RegExp(a)[t](String(o))},function(t){var i=o(a,t,this);if(i.done)return i.value;var n=e(t),l=String(this);if(!n.global)return c(n,l);var u=n.unicode;n.lastIndex=0;var d,v=[],h=0;while(null!==(d=c(n,l))){var m=String(d[0]);v[h]=m,""===m&&(n.lastIndex=r(l,s(n.lastIndex),u)),h++}return 0===h?null:v}]}))},"5bcd":function(t,a,o){},"75bc":function(t,a,o){"use strict";o("5bcd")},"83ad":function(t,a,o){},d5e0:function(t,a,o){"use strict";o("83ad")},fb6a:function(t,a,o){"use strict";var i=o("23e7"),e=o("861d"),s=o("e8b5"),n=o("23cb"),r=o("50c4"),c=o("fc6a"),l=o("8418"),u=o("b622"),d=o("1dde"),v=o("ae40"),h=d("slice"),m=v("slice",{ACCESSORS:!0,0:0,1:2}),f=u("species"),p=[].slice,g=Math.max;i({target:"Array",proto:!0,forced:!h||!m},{slice:function(t,a){var o,i,u,d=c(this),v=r(d.length),h=n(t,v),m=n(void 0===a?v:a,v);if(s(d)&&(o=d.constructor,"function"!=typeof o||o!==Array&&!s(o.prototype)?e(o)&&(o=o[f],null===o&&(o=void 0)):o=void 0,o===Array||void 0===o))return p.call(d,h,m);for(i=new(void 0===o?Array:o)(g(m-h,0)),u=0;h<m;h++,u++)h in d&&l(i,u,d[h]);return i.length=u,i}})}}]);
//# sourceMappingURL=chunk-f2f81c36.60b7a8f5.js.map